pihole_package:
  automation:
    - alias: Notify users that pihole is enabled
      trigger:
        platform: state
        entity_id:
          - switch.pihole
        to: 'off'
        for:
          hours: 1
      action:
        - service: switch.turn_on
          target:
            entity_id: switch.pi_hole
        - service: notify.mobile_app_andrew_s_iphone
          data:
            title: "PiHole is re-enabled"
            message: "PiHole has been disabled for an hour and is now re-enabled."
            data:
              push:
                category: pihole
    
    - alias: Turn on pihole from mobile notification
      trigger:
        platform: event
        event_type: ios.notification_action_fired
        event_data:
          actionName: DISABLE_PIHOLE
      action:
        - service: switch.turn_off
          target:
            entity_id: switch.pi_hole

  ios:
    push:
      categories:
        - name: pihole
          identifier: pihole
          actions:
            - identifier: DISABLE_PIHOLE
              title: Disable PiHole
              activationMode: background
              authenticationRequired: false
              destructive: true
              behavior: default