input_number:
  target_daytime_temp_input:
    name: Target Daytime Temperature Input
    initial: 70
    step: 1
    min: 55
    max: 80
  target_nighttime_temp_input:
    name: Target Nightime Temperature Input
    initial: 68
    step: 1
    min: 55
    max: 80
  target_away_low_temp_input:
    name: Target Away Low Temperature Input
    initial: 60
    step: 1
    min: 55
    max: 80
  target_away_high_temp_input:
    name: Target Away High Temperature Input
    initial: 78
    step: 1
    min: 55
    max: 80

sensor:
  - platform: template
    sensors:
      season:
        friendly_name: Hot or cold season
        value_template: >
          {% if (state_attr('weather.home', 'temperature')|int) <= 60 %}
            cold
          {% else %}
            hot
          {%endif %}
      target_low_temp:
        friendly_name: Target Low Temperature
        value_template: >
          {% if is_state('group.tracked_presence', 'away') %}
            {% if is_state('sensor.season', 'cold') %}
              "{{ states('sensor.target_away_low_temp_input') | int }}"
            {% else %}
              "{{ ((states('sensor.target_away_high_temp_input') | int) - 5) | int }}"
            {% endif %}
          {% else %}
            {% if is_state('group.family_is_sleeping', 'on') %}
                {% if is_state('sensor.season', 'cold') %}
                  "{{ states('sensor.target_nighttime_temp_input') | int }}"
                {% else %}
                  "{{ ((states('sensor.target_nighttime_temp_input') | int) - 6) | int }}"
                {% endif %}
            {% else %}
              {% if is_state('sensor.season', 'cold') %}
                  "{{ ((states('sensor.target_daytime_temp_input') | int) - 1) | int }}"
                {% else %}
                  "{{ ((states('sensor.target_daytime_temp_input') | int) - 6) | int}}"
                {% endif %}
            {% endif %}
          {% endif %}
      target_high_temp:
        friendly_name: Target High Temperature
        value_template: "{{ ((states('sensor.target_min_temp_input') | int) + 4) | int }}"
