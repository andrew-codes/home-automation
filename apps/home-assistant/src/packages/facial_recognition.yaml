automation:
  - alias: Notify that Andrew's face was recognized
    id: notify_andrew_face_was_recognized
    trigger:
      - platform: state
        entity_id: sensor.andrew_s_face_match
    action:
      - service: notify.mobile_app_andrew_s_iphone
        data_template:
          title: Andrew Appeared
          message_template: "Andrew appeared at the {{ state_attr('sensor.andrew_s_face_match', 'camera') }}"

  - alias: Notify that matched face is at front door
    id: notify_matched_faces_at_front_door
    trigger:
      - platform: mqtt
        topic: "double-take/cameras/front_door"
    action:
      - service: notify.mobile_app_andrew_s_iphone
        data_template:
          title: Someone is at the Front Door
          message_template: >
            Recognized at the front door: {{ trigger.payload_json.matches | map(attribute='name') | join(', ')}}
