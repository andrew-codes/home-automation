template:
  - binary_sensor:
      - name: Guests recently detected at carport door
        unique_id: guests_recently_detected_at_carport_door
        state: >
          {% set carport_door_minutes_difference = (as_timestamp(now()) -
            as_timestamp(states.binary_sensor.car_port_door_person_occupancy.last_changed)) / 60 %}
          {{ ((carport_door_minutes_difference <= 5 and is_state('binary_sensor.car_port_door_person_occupancy', 'off')) or is_state('binary_sensor.car_port_door_person_occupancy', 'on') or is_state('binary_sensor.carport_doorbell_doorbell', 'on')) }}
      - name: Guests recently detected at front door
        unique_id: guests_recently_detected_at_front_door
        state: >
          {% set front_door_minutes_difference = (as_timestamp(now()) -
            as_timestamp(states.binary_sensor.front_door_person_occupancy.last_changed)) / 60 %}
          {{ ((front_door_minutes_difference <= 5 and is_state('binary_sensor.front_door_person_occupancy', 'off')) or is_state('binary_sensor.front_door_person_occupancy', 'on') or is_state('binary_sensor.front_doorbell_doorbell', 'on')) }}
      - name: Guests recently detected
        unique_id: guests_recently_detected
        state: >
          {{ is_state('binary_sensor.guests_recently_detected_at_carport_door', 'on') or is_state('binary_sensor.guests_recently_detected_at_front_door', 'on') }}

input_number:
  number_of_people_last_at_front_door:
    name: Number of people last at front door
    initial: 0
    step: 1
    min: 0
    max: 100
    mode: box

  number_of_people_last_at_carport_door:
    name: Number of people last at carport door
    initial: 0
    step: 1
    min: 0
    max: 100
    mode: box
