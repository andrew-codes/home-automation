automation:
  - alias: Notify family members when deadbolt batteries need to be changed
    id: low_battery_notification_deadbolts
    trigger:
      - platform: state
        entity_id: group.low_batteries
        to: "on"
    action:
      - service: notify.all_devices
        data_template:
          title: Change Batteries
          message: >
            {% for entity_id in states.group.low_batteries.attributes.entity_id %}{% set parts = entity_id.split('.') %}{% if states(entity_id) == 'on' %}{% if loop.first %}{% elif loop.last %} and {% else %}, {% endif %}{{ states[parts[0]][parts[1]].name }}{% endif %}{% endfor %}
