automation:
  - alias: Notify family members when deadbolt batteries need to be changed
    id: low_battery_notification_deadbolts
    trigger:
      - platform: state
        entity_id: group.low_batteries
        to: "on"
    action:
      - service: notify.all_devices
        data_template:
          title: Replace Batteries
          message: >
            {% for entity_id in expand('group.low_batteries') | selectattr('state', 'eq', 'on')| map(attribute='entity_id') %}{% set parts = entity_id.split('.') %}{% if loop.first %}{% elif loop.last %} and {% else %}, {% endif %}{{ state_attr(entity_id, 'friendly_name') }}{% endfor %}
